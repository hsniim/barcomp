generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
}

model articles {
  id           String           @id @default(dbgenerated("(uuid())")) @db.VarChar(36)
  title        String           @db.VarChar(255)
  slug         String           @unique(map: "slug") @db.VarChar(255)
  excerpt      String           @db.Text
  content      String           @db.LongText
  cover_image  String           @db.VarChar(500)
  author_id    String           @db.VarChar(36)
  category     String           @db.VarChar(50)
  tags         Json?
  featured     Boolean?         @default(false)
  read_time    Int?             @default(0)
  views        Int?             @default(0)
  status       articles_status? @default(draft)
  published_at DateTime?        @db.Timestamp(0)
  created_at   DateTime?        @default(now()) @db.Timestamp(0)
  updated_at   DateTime?        @default(now()) @db.Timestamp(0)
  users        users            @relation(fields: [author_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "articles_ibfk_1")
  comments     comments[]

  @@index([author_id], map: "idx_author_id")
  @@index([category], map: "idx_category")
  @@index([featured], map: "idx_featured")
  @@index([published_at], map: "idx_published_at")
  @@index([slug], map: "idx_slug")
  @@index([status], map: "idx_status")
  @@fulltext([title, excerpt, content], map: "idx_search")
}

model comments {
  id                                String           @id @default(dbgenerated("(uuid())")) @db.VarChar(36)
  article_id                        String           @db.VarChar(36)
  user_id                           String?          @db.VarChar(36)
  parent_id                         String?          @db.VarChar(36)
  content                           String           @db.Text
  status                            comments_status? @default(pending)
  approved_by                       String?          @db.VarChar(36)
  approved_at                       DateTime?        @db.Timestamp(0)
  likes_count                       Int?             @default(0)
  created_at                        DateTime?        @default(now()) @db.Timestamp(0)
  updated_at                        DateTime?        @default(now()) @db.Timestamp(0)
  deleted_at                        DateTime?        @db.Timestamp(0)
  articles                          articles         @relation(fields: [article_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "comments_ibfk_1")
  users_comments_user_idTousers     users?           @relation("comments_user_idTousers", fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "comments_ibfk_2")
  comments                          comments?        @relation("commentsTocomments", fields: [parent_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "comments_ibfk_3")
  other_comments                    comments[]       @relation("commentsTocomments")
  users_comments_approved_byTousers users?           @relation("comments_approved_byTousers", fields: [approved_by], references: [id], onUpdate: NoAction, map: "comments_ibfk_4")

  @@index([approved_by], map: "approved_by")
  @@index([article_id], map: "idx_article_id")
  @@index([created_at], map: "idx_created_at")
  @@index([parent_id], map: "idx_parent_id")
  @@index([status], map: "idx_status")
  @@index([user_id], map: "idx_user_id")
}

model event_registrations {
  id             String                              @id @default(dbgenerated("(uuid())")) @db.VarChar(36)
  event_id       String                              @db.VarChar(36)
  user_id        String?                             @db.VarChar(36)
  name           String                              @db.VarChar(255)
  email          String                              @db.VarChar(255)
  phone          String?                             @db.VarChar(50)
  company        String?                             @db.VarChar(255)
  custom_data    Json?
  payment_status event_registrations_payment_status? @default(pending)
  payment_proof  String?                             @db.VarChar(500)
  payment_amount Decimal?                            @db.Decimal(10, 2)
  checked_in     Boolean?                            @default(false)
  checked_in_at  DateTime?                           @db.Timestamp(0)
  created_at     DateTime?                           @default(now()) @db.Timestamp(0)
  updated_at     DateTime?                           @default(now()) @db.Timestamp(0)
  events         events                              @relation(fields: [event_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "event_registrations_ibfk_1")
  users          users?                              @relation(fields: [user_id], references: [id], onUpdate: NoAction, map: "event_registrations_ibfk_2")

  @@index([created_at], map: "idx_created_at")
  @@index([email], map: "idx_email")
  @@index([event_id], map: "idx_event_id")
  @@index([payment_status], map: "idx_payment_status")
  @@index([user_id], map: "idx_user_id")
}

model events {
  id                    String                @id @default(dbgenerated("(uuid())")) @db.VarChar(36)
  title                 String                @db.VarChar(255)
  slug                  String                @unique(map: "slug") @db.VarChar(255)
  description           String                @db.Text
  cover_image           String                @db.VarChar(500)
  event_type            events_event_type
  location_type         events_location_type
  location_venue        String?               @db.VarChar(255)
  location_address      String?               @db.Text
  location_city         String?               @db.VarChar(100)
  location_country      String?               @db.VarChar(100)
  location_lat          Decimal?              @db.Decimal(10, 8)
  location_lng          Decimal?              @db.Decimal(11, 8)
  start_date            DateTime              @db.DateTime(0)
  end_date              DateTime              @db.DateTime(0)
  registration_deadline DateTime              @db.DateTime(0)
  capacity              Int
  registered_count      Int?                  @default(0)
  status                events_status?        @default(upcoming)
  tags                  Json?
  featured              Boolean?              @default(false)
  speakers              Json?
  agenda                Json?
  registration_url      String?               @db.VarChar(500)
  price_amount          Decimal?              @default(0.00) @db.Decimal(10, 2)
  price_currency        String?               @default("IDR") @db.VarChar(3)
  is_free               Boolean?              @default(false)
  created_at            DateTime?             @default(now()) @db.Timestamp(0)
  updated_at            DateTime?             @default(now()) @db.Timestamp(0)
  event_registrations   event_registrations[]
  gallery               gallery[]

  @@index([event_type], map: "idx_event_type")
  @@index([featured], map: "idx_featured")
  @@index([location_city], map: "idx_location_city")
  @@index([slug], map: "idx_slug")
  @@index([start_date], map: "idx_start_date")
  @@index([status], map: "idx_status")
}

model gallery {
  id            String    @id @default(dbgenerated("(uuid())")) @db.VarChar(36)
  title         String    @db.VarChar(255)
  description   String?   @db.Text
  image_url     String    @db.VarChar(500)
  thumbnail_url String    @db.VarChar(500)
  category      String    @db.VarChar(50)
  tags          Json?
  event_id      String?   @db.VarChar(36)
  width         Int
  height        Int
  photographer  String?   @db.VarChar(255)
  captured_at   DateTime  @db.DateTime(0)
  uploaded_at   DateTime? @default(now()) @db.Timestamp(0)
  featured      Boolean?  @default(false)
  display_order Int?      @default(0)
  events        events?   @relation(fields: [event_id], references: [id], onUpdate: NoAction, map: "gallery_ibfk_1")

  @@index([captured_at], map: "idx_captured_at")
  @@index([category], map: "idx_category")
  @@index([display_order], map: "idx_display_order")
  @@index([event_id], map: "idx_event_id")
  @@index([featured], map: "idx_featured")
}

model sessions {
  id            String    @id @default(dbgenerated("(uuid())")) @db.VarChar(36)
  user_id       String    @db.VarChar(36)
  session_token String    @unique(map: "session_token") @db.VarChar(255)
  refresh_token String?   @unique(map: "refresh_token") @db.VarChar(255)
  ip_address    String?   @db.VarChar(45)
  user_agent    String?   @db.Text
  device_type   String?   @db.VarChar(50)
  expires_at    DateTime  @db.Timestamp(0)
  created_at    DateTime? @default(now()) @db.Timestamp(0)
  updated_at    DateTime? @default(now()) @db.Timestamp(0)
  users         users     @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "sessions_ibfk_1")

  @@index([expires_at], map: "idx_expires_at")
  @@index([session_token], map: "idx_session_token")
  @@index([user_id], map: "idx_user_id")
}

model user_activity_logs {
  id            String    @id @default(dbgenerated("(uuid())")) @db.VarChar(36)
  user_id       String?   @db.VarChar(36)
  activity_type String    @db.VarChar(50)
  description   String?   @db.Text
  ip_address    String?   @db.VarChar(45)
  user_agent    String?   @db.Text
  url           String?   @db.VarChar(500)
  metadata      Json?
  created_at    DateTime? @default(now()) @db.Timestamp(0)
  users         users?    @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "user_activity_logs_ibfk_1")

  @@index([activity_type], map: "idx_activity_type")
  @@index([created_at], map: "idx_created_at")
  @@index([ip_address], map: "idx_ip_address")
  @@index([user_id], map: "idx_user_id")
}

model users {
  id                                   String                @id @default(dbgenerated("(uuid())")) @db.VarChar(36)
  email                                String                @unique(map: "email") @db.VarChar(255)
  password                             String                @db.VarChar(255)
  full_name                            String                @db.VarChar(255)
  username                             String?               @unique(map: "username") @db.VarChar(100)
  phone                                String?               @db.VarChar(50)
  avatar                               String?               @default("/images/default-avatar.jpg") @db.VarChar(500)
  bio                                  String?               @db.Text
  company                              String?               @db.VarChar(255)
  job_title                            String?               @db.VarChar(255)
  address                              String?               @db.Text
  city                                 String?               @db.VarChar(100)
  province                             String?               @db.VarChar(100)
  country                              String?               @default("Indonesia") @db.VarChar(100)
  postal_code                          String?               @db.VarChar(20)
  role                                 users_role?           @default(user)
  status                               users_status?         @default(active)
  email_verified                       Boolean?              @default(false)
  email_verified_at                    DateTime?             @db.Timestamp(0)
  verification_token                   String?               @db.VarChar(255)
  reset_token                          String?               @db.VarChar(255)
  reset_token_expires                  DateTime?             @db.Timestamp(0)
  linkedin_url                         String?               @db.VarChar(255)
  twitter_url                          String?               @db.VarChar(255)
  instagram_url                        String?               @db.VarChar(255)
  website_url                          String?               @db.VarChar(255)
  last_login_at                        DateTime?             @db.Timestamp(0)
  last_login_ip                        String?               @db.VarChar(45)
  login_count                          Int?                  @default(0)
  language                             String?               @default("id") @db.VarChar(2)
  timezone                             String?               @default("Asia/Jakarta") @db.VarChar(50)
  newsletter_subscribed                Boolean?              @default(true)
  notifications_enabled                Boolean?              @default(true)
  admin_notes                          String?               @db.Text
  created_at                           DateTime?             @default(now()) @db.Timestamp(0)
  updated_at                           DateTime?             @default(now()) @db.Timestamp(0)
  deleted_at                           DateTime?             @db.Timestamp(0)
  articles                             articles[]
  comments_comments_user_idTousers     comments[]            @relation("comments_user_idTousers")
  comments_comments_approved_byTousers comments[]            @relation("comments_approved_byTousers")
  event_registrations                  event_registrations[]
  sessions                             sessions[]
  user_activity_logs                   user_activity_logs[]

  @@index([created_at], map: "idx_created_at")
  @@index([deleted_at], map: "idx_deleted_at")
  @@index([email], map: "idx_email")
  @@index([role], map: "idx_role")
  @@index([status], map: "idx_status")
  @@index([username], map: "idx_username")
  @@fulltext([full_name, email, company], map: "idx_search")
}

enum comments_status {
  pending
  approved
  rejected
  spam
}

enum events_event_type {
  workshop
  seminar
  webinar
  conference
  training
}

enum events_location_type {
  online
  onsite
  hybrid
}

enum event_registrations_payment_status {
  pending
  paid
  cancelled
  refunded
}

enum articles_status {
  draft
  published
  archived
}

enum users_role {
  super_admin
  admin
  editor
  user
}

enum users_status {
  active
  inactive
  suspended
  banned
}

enum events_status {
  upcoming
  ongoing
  completed
  cancelled
}
